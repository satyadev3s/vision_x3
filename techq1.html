<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tech ‚Äî Level 1</title>
<style>
:root{--bg:linear-gradient(135deg,#1e3c72,#2a5298,#7e8ba3);}
html,body{height:100%;margin:0;font-family:Segoe UI,Roboto,Arial}
#app{height:100vh;display:flex;flex-direction:column;background:var(--bg);color:#fff}
.header{padding:20px;background:linear-gradient(90deg,#e74c3c,#c0392b);display:flex;justify-content:space-between;align-items:center;font-weight:900}
.progress-bar{height:6px;background:rgba(255,255,255,.18)}
.progress-fill{height:100%;width:25%;transition:width .35s;background:linear-gradient(90deg,#2ecc71,#27ae60)}
.content{padding:22px;flex:1;overflow:auto}
.question-text{font-size:1.6rem;font-weight:900;margin-bottom:18px}
.answer-button{display:block;width:100%;padding:14px;margin-bottom:12px;border-radius:12px;border:none;background:linear-gradient(135deg,#b0bec5,#90a4ae);color:#111;font-weight:800;cursor:pointer;box-shadow:0 8px 16px rgba(0,0,0,.15);transition:transform .18s,background .18s}
.answer-button:disabled{cursor:not-allowed;opacity:.95}
.correct{background:linear-gradient(135deg,#27ae60,#229954)!important;color:#fff}
.incorrect{background:linear-gradient(135deg,#e74c3c,#c0392b)!important;color:#fff}
.footer{display:flex;justify-content:space-between;align-items:center;padding:16px;background:linear-gradient(90deg,rgba(0,0,0,.12),rgba(0,0,0,.06))}
.btn-small{padding:10px 14px;border-radius:10px;border:none;font-weight:900;color:#fff;cursor:pointer}
.back{background:linear-gradient(135deg,#558B2F,#33691e)}
.next{background:linear-gradient(135deg,#1976D2,#1565C0);display:none}
.next.show{display:inline-block}
.timer{font-weight:900}
</style>
</head>
<body>
<div id="app">
  <div class="header">
    <div id="question-number">üíª 1. Question</div>
    <div>‚è≥ <span id="timer">30</span>s</div>
  </div>

  <div class="progress-bar"><div id="progress-fill" class="progress-fill" style="width:25%"></div></div>

  <div class="content">
    <div id="question-text" class="question-text">Loading‚Ä¶</div>

    <button class="answer-button" data-answer="a" onclick="selectAnswer(this,'a')"></button>
    <button class="answer-button" data-answer="b" onclick="selectAnswer(this,'b')"></button>
    <button class="answer-button" data-answer="c" onclick="selectAnswer(this,'c')"></button>
    <button class="answer-button" data-answer="d" onclick="selectAnswer(this,'d')"></button>
  </div>

  <div class="footer">
    <div>Score: <strong id="current-score">0</strong>/<span id="total-questions">4</span></div>
    <div style="display:flex;gap:8px;align-items:center">
      <button id="back-button" class="btn-small back" onclick="goBack()" disabled>‚Üê Back</button>
      <button id="next-button" class="btn-small next" onclick="goNext()">Next ‚Üí</button>
    </div>
  </div>
</div>

<script>
const TIME_PER_Q = 30; // seconds, per your request (remembers remaining time on back)
const LEVEL = 1;
const questions = [
  { number:1, text:"What does HTML stand for?", answers:[{l:'a',t:'Hyper Text Markup Language'},{l:'b',t:'High Tech Modern Language'},{l:'c',t:'Home Tool Markup Language'},{l:'d',t:'Hyperlinks and Text Markup Language'}], correct:'a', user:null, remaining:TIME_PER_Q },
  { number:2, text:"Which tag is used for a paragraph?", answers:[{l:'a',t:'<p>'},{l:'b',t:'<para>'},{l:'c',t:'<text>'},{l:'d',t:'<div>'}], correct:'a', user:null, remaining:TIME_PER_Q },
  { number:3, text:"Which attribute sets the URL for a link?", answers:[{l:'a',t:'src'},{l:'b',t:'href'},{l:'c',t:'link'},{l:'d',t:'url'}], correct:'b', user:null, remaining:TIME_PER_Q },
  { number:4, text:"Which tag creates an unordered list?", answers:[{l:'a',t:'<ol>'},{l:'b',t:'<li>'},{l:'c',t:'<ul>'},{l:'d',t:'<list>'}], correct:'c', user:null, remaining:TIME_PER_Q }
];

let state = { idx:0, timerInterval:null };

const DOM = {
  qText: document.getElementById('question-text'),
  buttons: document.querySelectorAll('.answer-button'),
  nextBtn: document.getElementById('next-button'),
  backBtn: document.getElementById('back-button'),
  score: document.getElementById('current-score'),
  total: document.getElementById('total-questions'),
  qNum: document.getElementById('question-number'),
  progress: document.getElementById('progress-fill'),
  timer: document.getElementById('timer')
};

function render(){
  const q = questions[state.idx];
  DOM.qNum.textContent = `üíª ${q.number}. Question`;
  DOM.qText.textContent = q.text;
  DOM.total.textContent = questions.length;
  DOM.score.textContent = questions.filter(x=>x.user===x.correct).length;
  DOM.progress.style.width = (((state.idx+1)/questions.length)*100) + '%';
  DOM.buttons.forEach((btn,i) => {
    const a = q.answers[i];
    btn.textContent = `${a.l}) ${a.t}`;
    btn.dataset.answer = a.l;
    btn.classList.remove('correct','incorrect');
    btn.disabled = q.user !== null;
    btn.style.opacity = '1';
    if(q.user !== null){
      if(a.l === q.correct) btn.classList.add('correct');
      else if(a.l === q.user) btn.classList.add('incorrect');
      else btn.style.opacity = '0.5';
    }
  });
  DOM.nextBtn.classList[q.user !== null ? 'add' : 'remove']('show');
  DOM.backBtn.disabled = state.idx === 0;
  DOM.timer.textContent = q.remaining;
  startTimer();
}

function startTimer(){
  stopTimer();
  const q = questions[state.idx];
  DOM.timer.textContent = q.remaining;
  if (q.remaining <= 0) { // just in case
    onTimeUp();
    return;
  }
  state.timerInterval = setInterval(() => {
    q.remaining--;
    DOM.timer.textContent = q.remaining;
    if(q.remaining <= 0){
      stopTimer();
      onTimeUp();
    }
  }, 1000);
}

function stopTimer(){
  if(state.timerInterval) { clearInterval(state.timerInterval); state.timerInterval = null; }
}

function onTimeUp(){
  const q = questions[state.idx];
  if(q.user === null){
    q.user = 'timeout'; // mark answered wrong
  }
  // give short visual feedback then advance
  DOM.buttons.forEach(b => b.disabled = true);
  const correctBtn = [...DOM.buttons].find(b => b.dataset.answer === q.correct);
  if(correctBtn) correctBtn.classList.add('correct');
  setTimeout(() => {
    advanceOrFinish();
  }, 700);
}

function selectAnswer(btn, choice){
  const q = questions[state.idx];
  if(q.user !== null) return;
  // stop timer immediately (option A)
  stopTimer();
  q.user = choice;
  DOM.buttons.forEach(b => b.disabled = true);
  if(choice === q.correct) btn.classList.add('correct'); else { btn.classList.add('incorrect'); const correctBtn = [...DOM.buttons].find(b=>b.dataset.answer===q.correct); if(correctBtn) correctBtn.classList.add('correct'); }
  DOM.score.textContent = questions.filter(x=>x.user===x.correct).length;
  setTimeout(()=> DOM.nextBtn.classList.add('show'), 400);
}

function goNext(){
  stopTimer();
  if(state.idx < questions.length -1){ state.idx++; render(); } else { finish(); }
}

function goBack(){
  stopTimer();
  if(state.idx === 0){
    if(confirm('Exit quiz? Progress will not be saved.')) location.href='dashboard.html';
    return;
  }
  state.idx--;
  render();
}

function advanceOrFinish(){
  if(state.idx < questions.length -1){ state.idx++; render(); } else { finish(); }
}

function finish(){
  stopTimer();
  const s = questions.filter(x=>x.user===x.correct).length;
  const t = questions.length;
  const pct = (s/t)*100;
  const msg = pct>=75 ? 'üéâ Excellent!' : pct>=50 ? 'üëç Good!' : 'üìö Keep Learning!';
  alert(`${msg}\n\nLevel ${LEVEL} Completed!\nFinal Score: ${s}/${t}\n${pct.toFixed(1)}%`);
  sessionStorage.setItem(`level${LEVEL}_completed`, 'true');
sessionStorage.setItem("completedLevel", LEVEL);   // üí• REQUIRED for unlocking next level
location.href = 'drinkwatertechnical.html';

}

document.addEventListener('DOMContentLoaded', ()=>{ render(); });
</script>
</body>
</html>
